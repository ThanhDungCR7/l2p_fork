# coding=utf-8
# Copyright 2020 The Learning-to-Prompt Authors.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific Learning-to-Prompt governing permissions and
# limitations under the License.
# ==============================================================================
"""Label mapping for ImageNet-R."""
import numpy as np
import tensorflow as tf

# map 200 classes in ImageNet-R to 0-199
IR_LABEL_MAP = {
    1: 0,
    2: 1,
    4: 2,
    6: 3,
    8: 4,
    9: 5,
    11: 6,
    13: 7,
    22: 8,
    23: 9,
    26: 10,
    29: 11,
    31: 12,
    39: 13,
    47: 14,
    63: 15,
    71: 16,
    76: 17,
    79: 18,
    84: 19,
    90: 20,
    94: 21,
    96: 22,
    97: 23,
    99: 24,
    100: 25,
    105: 26,
    107: 27,
    113: 28,
    122: 29,
    125: 30,
    130: 31,
    132: 32,
    144: 33,
    145: 34,
    147: 35,
    148: 36,
    150: 37,
    151: 38,
    155: 39,
    160: 40,
    161: 41,
    162: 42,
    163: 43,
    171: 44,
    172: 45,
    178: 46,
    187: 47,
    195: 48,
    199: 49,
    203: 50,
    207: 51,
    208: 52,
    219: 53,
    231: 54,
    232: 55,
    234: 56,
    235: 57,
    242: 58,
    245: 59,
    247: 60,
    250: 61,
    251: 62,
    254: 63,
    259: 64,
    260: 65,
    263: 66,
    265: 67,
    267: 68,
    269: 69,
    276: 70,
    277: 71,
    281: 72,
    288: 73,
    289: 74,
    291: 75,
    292: 76,
    293: 77,
    296: 78,
    299: 79,
    301: 80,
    308: 81,
    309: 82,
    310: 83,
    311: 84,
    314: 85,
    315: 86,
    319: 87,
    323: 88,
    327: 89,
    330: 90,
    334: 91,
    335: 92,
    337: 93,
    338: 94,
    340: 95,
    341: 96,
    344: 97,
    347: 98,
    353: 99,
    355: 100,
    361: 101,
    362: 102,
    365: 103,
    366: 104,
    367: 105,
    368: 106,
    372: 107,
    388: 108,
    390: 109,
    393: 110,
    397: 111,
    401: 112,
    407: 113,
    413: 114,
    414: 115,
    425: 116,
    428: 117,
    430: 118,
    435: 119,
    437: 120,
    441: 121,
    447: 122,
    448: 123,
    457: 124,
    462: 125,
    463: 126,
    469: 127,
    470: 128,
    471: 129,
    472: 130,
    476: 131,
    483: 132,
    487: 133,
    515: 134,
    546: 135,
    555: 136,
    558: 137,
    570: 138,
    579: 139,
    583: 140,
    587: 141,
    593: 142,
    594: 143,
    596: 144,
    609: 145,
    613: 146,
    617: 147,
    621: 148,
    629: 149,
    637: 150,
    657: 151,
    658: 152,
    701: 153,
    717: 154,
    724: 155,
    763: 156,
    768: 157,
    774: 158,
    776: 159,
    779: 160,
    780: 161,
    787: 162,
    805: 163,
    812: 164,
    815: 165,
    820: 166,
    824: 167,
    833: 168,
    847: 169,
    852: 170,
    866: 171,
    875: 172,
    883: 173,
    889: 174,
    895: 175,
    907: 176,
    928: 177,
    931: 178,
    932: 179,
    933: 180,
    934: 181,
    936: 182,
    937: 183,
    943: 184,
    945: 185,
    947: 186,
    948: 187,
    949: 188,
    951: 189,
    953: 190,
    954: 191,
    957: 192,
    963: 193,
    965: 194,
    967: 195,
    980: 196,
    981: 197,
    983: 198,
    988: 199
}


IR_LABEL_MAP_NP = -np.ones((1000,))
for key, value in IR_LABEL_MAP.items():
  IR_LABEL_MAP_NP[key] = value
IR_LABEL_MAP_TF = tf.convert_to_tensor(IR_LABEL_MAP_NP, dtype=tf.int64)

# list of original class IDs of split ImageNet-R
IR_LABEL_LIST = [
    1, 2, 4, 6, 8, 9, 11, 13, 22, 23, 26, 29, 31, 39, 47, 63, 71, 76, 79, 84,
    90, 94, 96, 97, 99, 100, 105, 107, 113, 122, 125, 130, 132, 144, 145, 147,
    148, 150, 151, 155, 160, 161, 162, 163, 171, 172, 178, 187, 195, 199, 203,
    207, 208, 219, 231, 232, 234, 235, 242, 245, 247, 250, 251, 254, 259, 260,
    263, 265, 267, 269, 276, 277, 281, 288, 289, 291, 292, 293, 296, 299, 301,
    308, 309, 310, 311, 314, 315, 319, 323, 327, 330, 334, 335, 337, 338, 340,
    341, 344, 347, 353, 355, 361, 362, 365, 366, 367, 368, 372, 388, 390, 393,
    397, 401, 407, 413, 414, 425, 428, 430, 435, 437, 441, 447, 448, 457, 462,
    463, 469, 470, 471, 472, 476, 483, 487, 515, 546, 555, 558, 570, 579, 583,
    587, 593, 594, 596, 609, 613, 617, 621, 629, 637, 657, 658, 701, 717, 724,
    763, 768, 774, 776, 779, 780, 787, 805, 812, 815, 820, 824, 833, 847, 852,
    866, 875, 883, 889, 895, 907, 928, 931, 932, 933, 934, 936, 937, 943, 945,
    947, 948, 949, 951, 953, 954, 957, 963, 965, 967, 980, 981, 983, 988
]

IR_LABEL_LIST_NP = np.array(IR_LABEL_LIST)
